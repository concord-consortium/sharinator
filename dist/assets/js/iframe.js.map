{"version":3,"sources":["webpack:///./src/iframe.tsx","webpack:///./src/components/iframe.tsx","webpack:///./src/components/iframe-overlay.tsx"],"names":[],"mappings":"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","file":"iframe.js","sourcesContent":["import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { IFrame } from \"./components/iframe\"\n\nReactDOM.render(\n    <IFrame />,\n    document.getElementById(\"app\")\n);\n\n\n// WEBPACK FOOTER //\n// ./src/iframe.tsx","import * as React from \"react\";\nimport { IFrameOverlay } from \"./iframe-overlay\"\n\nconst queryString = require(\"query-string\")\nconst superagent = require(\"superagent\")\n\ndeclare var firebase: any  // @types/firebase is not Firebase 3\ndeclare var iframePhone: any\n\nexport interface IFrameProps {\n}\n\nexport interface IFrameState {\n  src: string|null\n  irsUrl: string|null\n  copyUrl: string|null\n  authoring: boolean,\n  authoredState: AuthoredState|null,\n  authoringError: string|null\n  initInteractiveData: InitInteractiveData|null\n}\n\nexport interface AuthoredState {\n  laraSharedUrl: string\n  docStoreUrl: string\n  autoLaunchUrl: string\n  codapUrl: string\n}\n\nexport interface InteractiveRunStateData {\n  docStoreUrl: string\n  copyUrl: string\n}\n\nexport interface InitInteractiveData {\n  version: number\n  error: string|null\n  mode: \"authoring\"|\"runtime\"\n  authoredState: AuthoredState\n  interactiveState: any|null\n  globalInteractiveState: any|null\n  hasLinkedInteractive: boolean\n  linkedState: any|null\n  interactiveStateUrl: string\n  collaboratorUrls: string|null\n  publicClassHash: string|null\n  classInfoUrl: string|null\n  interactive: InitInteractiveInteractiveData\n  authInfo: InitInteractiveAuthInfoData\n}\n\nexport interface InitInteractiveInteractiveData {\n  id: number\n  name: string\n}\nexport interface InitInteractiveAuthInfoData {\n  provider: string\n  loggedIn: boolean\n  email: string\n}\n\nexport class IFrame extends React.Component<IFrameProps, IFrameState> {\n  private classroomRef:any\n  private clientPhone:any\n  private serverPhone:any\n\n  refs: {\n    [string: string]: any;\n    iframe: HTMLIFrameElement;\n    laraSharedUrl: HTMLInputElement;\n  }\n\n  constructor(props: IFrameProps) {\n    super(props)\n\n    this.submitAuthoringInfo = this.submitAuthoringInfo.bind(this)\n    this.getInteractiveState = this.getInteractiveState.bind(this)\n    this.delayedMount = this.delayedMount.bind(this)\n\n    this.state = {\n      irsUrl: null,\n      src: null,\n      authoring: false,\n      authoredState: null,\n      authoringError: null,\n      initInteractiveData: null,\n      copyUrl: null\n    }\n  }\n\n  componentDidMount() {\n    // TODO: figure out why iframe phone needs the delay\n    setTimeout(this.delayedMount, 1000)\n  }\n\n  delayedMount() {\n    this.clientPhone = iframePhone.getIFrameEndpoint()\n    this.clientPhone.addListener('initInteractive', (data:InitInteractiveData) => {\n      if (data.mode === \"authoring\") {\n        this.setState({\n          authoring: true,\n          authoredState: data.authoredState\n        })\n        return\n      }\n\n      const authoredState:AuthoredState = data.authoredState\n      const serverParams = {\n        componentMode: \"yes\",\n        documentServer: authoredState.docStoreUrl\n      }\n      const srcParams = {\n        server: `${authoredState.codapUrl}?${queryString.stringify(serverParams)}`\n      }\n      const src = `${authoredState.autoLaunchUrl}?${queryString.stringify(srcParams)}`\n\n      this.setState({\n        src: src,\n        irsUrl: data.interactiveStateUrl,\n        initInteractiveData: data,\n        authoredState: data.authoredState\n      })\n\n      if (data.interactiveStateUrl)  {\n        setTimeout(this.getInteractiveState, 1000)\n      }\n    })\n    this.clientPhone.initialize();\n    this.clientPhone.post('supportedFeatures', {\n      apiVersion: 1,\n      features: {\n        authoredState: true\n      }\n    })\n  }\n\n  componentDidUpdate() {\n    if (this.state.authoring) {\n      this.refs.laraSharedUrl.focus()\n    }\n    else if (this.refs.iframe && !this.serverPhone) {\n      // proxy the result of the initInteractive message from LARA to the docstore\n      this.serverPhone = new iframePhone.ParentEndpoint(this.refs.iframe, () => {\n        this.serverPhone.post(\"initInteractive\", this.state.initInteractiveData)\n      })\n    }\n  }\n\n  getInteractiveState() {\n    superagent\n      .get(this.state.irsUrl)\n      .withCredentials()\n      .set('Accept', 'application/json')\n      .end((err:any, res:any) => {\n        if (!err) {\n          try {\n            const json = JSON.parse(res.text)\n            if (json && json.raw_data) {\n              const rawData = JSON.parse(json.raw_data)\n              if (rawData && rawData.docStore && rawData.docStore.accessKeys && rawData.docStore.accessKeys.readOnly && this.state.authoredState) {\n                this.setState({\n                  copyUrl: `${this.state.authoredState.docStoreUrl}/v2/documents?source=${rawData.docStore.recordid}&accessKey=RO::${rawData.docStore.accessKeys.readOnly}`,\n                })\n              }\n              return\n            }\n          }\n          catch (e) {}\n          setTimeout(this.getInteractiveState, 1000)\n        }\n      });\n  }\n\n  submitAuthoringInfo(e:React.FormEvent<HTMLFormElement>) {\n    e.preventDefault()\n\n    const url = this.refs.laraSharedUrl.value\n    const [docStoreUrl, query, ...rest] = url.split(\"?\")\n    const urlMatches = docStoreUrl.match(/^((https?:\\/\\/[^/]+\\/)v2\\/documents\\/\\d+\\/(auto)?launch)/)\n    const launchParams = queryString.parse(query || \"\")\n\n    if (!urlMatches || !launchParams.server) {\n      this.setState({authoringError: \"This URL does not appear to be a shared URL from the LARA tab in CODAP\"})\n      return\n    }\n    this.setState({authoringError: null})\n\n    const authoredState:AuthoredState = {\n      laraSharedUrl: url,\n      docStoreUrl: this.matchProtocol(urlMatches[2].replace(/\\/+$/, \"\")), // remove trailing slashes\n      autoLaunchUrl: this.matchProtocol(urlMatches[1].replace(\"/launch\", \"/autolaunch\")), // change to autolaunch\n      codapUrl: this.matchProtocol(launchParams.server)\n    }\n\n    this.clientPhone.post('authoredState', authoredState)\n  }\n\n  matchProtocol(url:string):string {\n    const a = document.createElement(\"a\")\n    a.href = url\n    a.protocol = location.protocol\n    return a.href\n  }\n\n  renderAuthoring():JSX.Element {\n    const inputStyle = {width: \"100%\"}\n    const errorStyle = {color: \"#f00\", marginTop: 10, marginBottom: 10}\n    const url = (this.state.authoredState ? this.state.authoredState.laraSharedUrl : \"\") || \"\"\n    return <form onSubmit={this.submitAuthoringInfo}>\n             {this.state.authoringError ? <div style={errorStyle}>{this.state.authoringError}</div> : null}\n             <label htmlFor=\"laraSharedUrl\">Shared URL from LARA tab in CODAP</label>\n             <input type=\"text\" id=\"laraSharedUrl\" ref=\"laraSharedUrl\" style={inputStyle} defaultValue={url} />\n             <input type=\"submit\" value=\"Save\" />\n           </form>\n  }\n\n  renderIFrame():JSX.Element {\n    if (this.state.src && this.state.initInteractiveData && this.state.authoredState) {\n      return <div id=\"iframe\">\n              <iframe ref=\"iframe\" src={this.state.src}></iframe>\n              <IFrameOverlay initInteractiveData={this.state.initInteractiveData} copyUrl={this.state.copyUrl} authoredState={this.state.authoredState} />\n            </div>\n    }\n    return null\n  }\n\n  render() {\n    if (this.state.authoring) {\n      return this.renderAuthoring()\n    }\n    return this.renderIFrame()\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/iframe.tsx","import * as React from \"react\";\nimport {InitInteractiveData, AuthoredState} from \"./iframe\"\nimport {FirebaseInteractive} from \"./types\"\nimport {ClassInfoResultResponse} from \"./class-info\"\nimport escapeFirebaseKey from \"./escape-firebase-key\"\n\nconst queryString = require(\"query-string\")\nconst base64url = require(\"base64-url\")\nconst superagent = require(\"superagent\")\n\ndeclare var firebase: any;  // @types/firebase is not Firebase 3\n\nexport interface IFrameOverlayProps {\n  initInteractiveData: InitInteractiveData\n  authoredState: AuthoredState\n  copyUrl: string|null\n}\n\nexport interface IFrameOverlayState {\n  privateClassHash: string|null\n  loadingClassInfo: boolean\n  publishing: boolean\n  publishingError: string|null\n  publishingStatus: string|null\n}\n\ninterface CopyResults {\n  status: string\n  valid: boolean\n  id: number\n  readAccessKey: string\n  readWriteAccessKey: string\n}\n\nexport class IFrameOverlay extends React.Component<IFrameOverlayProps, IFrameOverlayState> {\n  private interactiveRef:any\n  private studentInteractivesRef:any\n\n  constructor(props: IFrameOverlayProps) {\n    super(props)\n\n    this.onPublish = this.onPublish.bind(this)\n    this.state = {\n      privateClassHash: null,\n      loadingClassInfo: false,\n      publishing: false,\n      publishingError: null,\n      publishingStatus: null\n    }\n  }\n\n  componentDidMount() {\n    if (!this.state.privateClassHash && !this.state.loadingClassInfo) {\n      this.setState({loadingClassInfo: true})\n      superagent\n        .get(this.props.initInteractiveData.classInfoUrl)\n        .withCredentials()\n        .set('Accept', 'application/json')\n        .end((err:any, res:any) => {\n          if (!err) {\n            try {\n              const result:ClassInfoResultResponse = JSON.parse(res.text)\n              if (result.response_type !== \"ERROR\") {\n                this.setState({\n                  loadingClassInfo: false,\n                  privateClassHash: result.private_class_hash\n                })\n              }\n            }\n            catch (e) {}\n          }\n        });\n    }\n  }\n\n  onPublish(e:React.MouseEvent<HTMLButtonElement>) {\n    e.preventDefault()\n\n    this.setState({\n      publishing: true,\n      publishingStatus: \"Publishing...\"\n    })\n\n    const data = this.props.initInteractiveData\n    const classroomKey = `classes/${this.state.privateClassHash}`\n    const interactiveKey = `${classroomKey}/interactives/interactive_${data.interactive.id}`\n    const studentInteractivesKey = `${classroomKey}/students/${escapeFirebaseKey(data.authInfo.email)}/interactives/interactive_${data.interactive.id}`\n\n    superagent\n      .post(this.props.copyUrl)\n      .set('Accept', 'application/json')\n      .end((err:any, res:any) => {\n        this.setState({publishing: false})\n\n        if (!err && this.props.authoredState) {\n          try {\n            const copyResults:CopyResults = JSON.parse(res.text)\n            if (copyResults && copyResults.id && copyResults.readAccessKey) {\n              const laraParams = {\n                recordid: copyResults.id,\n                accessKeys: {\n                  readOnly: copyResults.readAccessKey\n                }\n              }\n              const codapParams = {\n                componentMode: \"yes\",\n                documentServer: this.props.authoredState.docStoreUrl\n              }\n              const url = `${this.props.authoredState.codapUrl}?${queryString.stringify(codapParams)}#file=lara:${base64url.encode(JSON.stringify(laraParams))}`\n\n              // save the interactive name (noop after it is first set)\n              const firebaseInteractive:FirebaseInteractive = {name: data.interactive.name}\n              this.interactiveRef = this.interactiveRef || firebase.database().ref(interactiveKey)\n              this.interactiveRef.set(firebaseInteractive)\n\n              // push the copy\n              this.studentInteractivesRef = this.studentInteractivesRef || firebase.database().ref(studentInteractivesKey)\n              this.studentInteractivesRef.push().set({\n                url: url,\n                createdAt: firebase.database.ServerValue.TIMESTAMP\n              })\n            }\n            else {\n              err = \"Invalid response from copy document call\"\n            }\n          }\n          catch (e) {\n            err = e\n          }\n        }\n\n        this.setState({\n          publishingError: err ? err.toString() : null,\n          publishingStatus: !err ? \"Published!\" : null\n        })\n\n        if (!err) {\n          const clearPublishingStatus = () => {\n            this.setState({\n              publishingStatus: null\n            })\n          }\n          setTimeout(clearPublishingStatus, 2000)\n        }\n      });\n  }\n\n  renderPublishingError() {\n    if (!this.state.publishingError) {\n      return null\n    }\n    return <div className=\"error\">{this.state.publishingError}</div>\n  }\n\n  renderPublishingStatus() {\n    if (!this.state.publishingStatus) {\n      return null\n    }\n    return <div className=\"status\">{this.state.publishingStatus}</div>\n  }\n\n  render() {\n    if (!this.props.initInteractiveData || !this.state.privateClassHash) {\n      return null\n    }\n    const href = `../dashboard/?class=${base64url.encode(this.props.initInteractiveData.classInfoUrl)}`\n\n    return <div id=\"iframe-overlay\">\n             <div id=\"background\"></div>\n             <div id=\"buttons\">\n               <button className=\"button button-primary\" onClick={this.onPublish} disabled={this.state.publishing}>Publish</button>\n               <a className=\"button button-primary\" href={href} target=\"_blank\">View</a>\n             </div>\n             { this.renderPublishingError() }\n             { this.renderPublishingStatus() }\n           </div>\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/components/iframe-overlay.tsx"],"sourceRoot":""}